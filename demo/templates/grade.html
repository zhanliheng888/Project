<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{#sysname#}</title>
    <script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
    <link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="theme.css" type="text/css"> </head>

    <script type="text/javascript">
        $(document).ready(function() {
            $("#course").change(function() {
                self.location.href="?courseid="+$(this).val();
            })
            var currentorderby = "{$orderby}";
            var currentorderdir = "{$orderdir}";
            $("th").click(function() {
                if ($(this).attr("id")) {
                    var colid = $(this).attr("id");
                    if (colid==currentorderby) {
                        if (currentorderdir=="asc") //如果是升序，转为降序
                            self.location.href = "?orderby="+colid+"&orderdir=desc";
                        else //如果是降序，取消当前排序
                            self.location.href = "?"

                    }
                    else 
                        self.location.href = "?orderby="+colid;
                }
            })
        })
    </script>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="offset-md-1 col-md-10">

                    <h1>{#sysname#} - 成绩汇总</h1>
                        按课程过滤：{html_options id=course name=course options=$courses selected=$courseid}
                    
                    
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th id="stu_rollno">学号 <i class="fa fa-fw {if $orderby=='stu_rollno'}fa-sort-amount-{$orderdir}{/if}"></i></th>
                                <th>姓名</th>
                                <th>所学专业</th>
                                <th id="course_name">课程<i class="fa fa-fw {if $orderby=='course_name'}fa-sort-amount-{$orderdir}{/if}"></i></th>
                                <th id="mark_score">成绩<i class="fa fa-fw {if $orderby=='mark_score'}fa-sort-amount-{$orderdir}{/if}"></i></th>
                                <th>说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            {section name=grade loop=$grades}
                            <tr {if $currentpage eq 1 && $smarty.section.grade.rownum<=3} class="text-danger"{/if}>
                                <td class="text-center">{($currentpage-1)*$pagesize+$smarty.section.grade.rownum}</td>
                                <td><a href=" " {if $currentpage eq 1 && $smarty.section.grade.rownum<=3} class="text-danger"{/if}>{$grades[grade].stu_rollno}</a></td>
                                <td><a href="student.php?stu_id={$grades[grade].stu_id}" {if $currentpage eq 1 && $smarty.section.grade.rownum<=3} class="text-danger"{/if}>
                                    {$grades[grade].stu_name}
                                    {if $currentpage eq 1}
                                    {if $smarty.section.grade.rownum==1}
                                    <i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i>
                                    {elseif $smarty.section.grade.rownum==2}
                                    <i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i><i class="fa fa-fw fa-star"></i>
                                    {elseif $smarty.section.grade.rownum==3}
                                    <i class="fa fa-fw fa-star"></i>
                                    {/if}
                                    {/if}
                                </ a></td>
                                <td>{$grades[grade].major_name}</td>
                                <td>{$grades[grade].course_name}</td>
                                <td class="text-right {if $grades[grade].mark_score>=80}
                                    table-success
                                    {elseif $grades[grade].mark_score>=60}
                                    table-warning
                                    {else}
                                    table-danger
                                    {/if}"
                                    >{$grades[grade].mark_score}</td>
                                <td>{$grades[grade].mark_deec}</td>
                            </tr>
                            {sectionelse}
                                <tr>
                                    <td colspan-"7">没有成绩数据</td>
                                </tr>   
                            {/section}
                        </tbody>
                    </table>

                    <div class="col-md-12">
                            <ul class="pagination justify-content-center pagination-sm text-secondary">
                              <li class="page-item">
                                <a class="page-link" href="{if $currentpage neq 1}?{if $courseid neq 0}courseid={$courseid}&{/if}{if $orderby neq ''}orderby={$orderby}&{/if}{if $orderdir neq ''}orderdir={$orderdir}&{/if}page={$currentpage-1}{/if}">
                                  <span>«</span>
                                  <span class="sr-only">Previous</span>
                                </a>
                              </li>
                              {for $i=1 to $pagecount}
                              <li class="page-item {if $i==$currentpage}active{/if}">
                                <a class="page-link" href="?{if $courseid neq 0}courseid={$courseid}&{/if}{if $orderby neq ''}orderby={$orderby}&{/if}{if $orderdir neq ''}orderdir={$orderdir}&{/if}page={$i}">{$i}</a>
                              </li>
                              {/for}
                              <li class="page-item">
                                <a class="page-link" href="{if $currentpage neq $pagecount}?{if $courseid neq 0}courseid={$courseid}&{/if}{if $orderby neq ''}orderby={$orderby}&{/if}{if $orderdir neq ''}orderdir={$orderdir}&{/if}page={$currentpage+1}{/if}">
                                  <span>»</span>
                                  <span class="sr-only">Next</span>
                                </a>
                              </li>
                            </ul>
                          </div>
            </div>
        </div>
    </div>
</body>
</html>